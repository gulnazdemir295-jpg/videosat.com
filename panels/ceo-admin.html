<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VideoSat Platform - CEO Admin Panel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="panel-styles.css">
    <style>
        .admin-dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            margin: 20px;
        }
        
        .admin-sidebar {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            height: fit-content;
        }
        
        .admin-main {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
        }
        
        .module-card {
            background: #2a2a2a;
            border: 1px solid #404040;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .module-card:hover {
            border-color: #dc2626;
            transform: translateY(-2px);
        }
        
        .module-card.active {
            border-color: #dc2626;
            background: #2d1a1a;
        }
        
        .module-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-active {
            background: #28a745;
            color: white;
        }
        
        .status-inactive {
            background: #dc3545;
            color: white;
        }
        
        .status-maintenance {
            background: #ffc107;
            color: #000;
        }
        
        .settings-form {
            display: none;
        }
        
        .settings-form.active {
            display: block;
        }
        
        .permission-matrix {
            display: grid;
            grid-template-columns: 200px repeat(5, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .permission-header {
            background: #404040;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            border-radius: 5px;
        }
        
        .permission-cell {
            background: #2a2a2a;
            padding: 10px;
            text-align: center;
            border-radius: 5px;
        }
        
        .permission-checkbox {
            width: 20px;
            height: 20px;
        }
        
        .real-time-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: #2a2a2a;
            border: 1px solid #404040;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #dc2626;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #999;
            font-size: 14px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        .form-grid input, .form-grid select {
            padding: 8px;
            background: #0a0a0a;
            color: #fff;
            border: 1px solid #404040;
            border-radius: 6px;
        }
        .btn-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
        .btn { padding: 10px 14px; border-radius: 8px; border: 1px solid #404040; background: #2a2a2a; color:#fff; cursor:pointer; }
        .btn.primary { background:#dc2626; border-color:#dc2626; }
        .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 12px; color:#ddd; }
        .result-box { background:#0a0a0a; border:1px solid #404040; border-radius:10px; padding:10px; margin-top:10px; white-space:pre-wrap; }
        .section-divider { margin: 16px 0; height: 1px; background: #333; border: 0; }
        .section-title { color:#dc2626; margin: 14px 0 8px 0; font-weight: 600; }
        /* NEW: quick toolbar */
        .quick-toolbar { display:flex; flex-wrap:wrap; gap:10px; padding:12px; background:#0f0f0f; border:1px solid #333; border-radius:10px; margin:12px 0 18px 0; }
        .quick-toolbar .qt-label { color:#bbb; margin-right:8px; display:flex; align-items:center; gap:8px; }
    </style>
</head>
<body>
    <div class="panel-container">
        <header class="panel-header">
            <div class="header-left">
                <h1><i class="fas fa-crown"></i> CEO Admin Panel</h1>
                <p>Platform Yönetimi ve Modül Kontrolü</p>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <span class="welcome-label">Hoşgeldiniz</span>
                    <span class="user-name" id="userName">CEO Admin</span>
                </div>
                <button class="logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    Çıkış
                </button>
            </div>
        </header>

        <div class="admin-dashboard">
            <div class="admin-sidebar">
                <h3><i class="fas fa-cogs"></i> Modül Yönetimi</h3>
                <a href="/panels/ceo-admin.html#dashboard" class="module-card" style="text-decoration:none;display:block;">
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <div>
                            <h4 style="color:#fff;"><i class="fas fa-broadcast-tower"></i> Canlı Yayın İşlemleri</h4>
                            <p style="color:#999;font-size:12px;margin:5px 0;">Tüm canlı yayın ayarlarına git</p>
                        </div>
                        <span class="module-status status-active">Aç</span>
                    </div>
                </a>
                <div class="real-time-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="activeUsers">0</div>
                        <div class="stat-label">Aktif Kullanıcılar</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="liveStreams">0</div>
                        <div class="stat-label">Canlı Yayınlar</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalOrders">0</div>
                        <div class="stat-label">Toplam Siparişler</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="systemHealth">100%</div>
                        <div class="stat-label">Sistem Sağlığı</div>
                    </div>
                </div>

                <div class="module-list">
                    <div class="module-card" data-module="email">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4><i class="fas fa-envelope"></i> E-posta Servisi</h4>
                                <p style="color: #999; font-size: 12px; margin: 5px 0;">EmailJS entegrasyonu</p>
                            </div>
                            <span class="module-status status-active" id="email-status">Aktif</span>
                        </div>
                    </div>
                    <div class="module-card" data-module="payment">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4><i class="fas fa-credit-card"></i> Ödeme Sistemi</h4>
                                <p style="color: #999; font-size: 12px; margin: 5px 0;">Stripe/PayPal entegrasyonu</p>
                            </div>
                            <span class="module-status status-inactive" id="payment-status">Pasif</span>
                        </div>
                    </div>
                    <div class="module-card" data-module="livestream">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4><i class="fas fa-broadcast-tower"></i> Canlı Yayın</h4>
                                <p style="color: #999; font-size: 12px; margin: 5px 0;">WebRTC/AWS IVS</p>
                            </div>
                            <span class="module-status status-inactive" id="livestream-status">Pasif</span>
                        </div>
                    </div>
                    <div class="module-card" data-module="cargo">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4><i class="fas fa-truck"></i> Kargo Takip</h4>
                                <p style="color: #999; font-size: 12px; margin: 5px 0;">Aras Kargo API</p>
                            </div>
                            <span class="module-status status-inactive" id="cargo-status">Pasif</span>
                        </div>
                    </div>
                    <div class="module-card" data-module="inventory">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4><i class="fas fa-boxes"></i> Stok Yönetimi</h4>
                                <p style="color: #999; font-size: 12px; margin: 5px 0;">Gerçek zamanlı stok</p>
                            </div>
                            <span class="module-status status-inactive" id="inventory-status">Pasif</span>
                        </div>
                    </div>
                    <div class="module-card" data-module="notifications">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4><i class="fas fa-bell"></i> Bildirimler</h4>
                                <p style="color: #999; font-size: 12px; margin: 5px 0;">Firebase Cloud Messaging</p>
                            </div>
                            <span class="module-status status-inactive" id="notifications-status">Pasif</span>
                        </div>
                    </div>
                    <div class="module-card" data-module="database">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4><i class="fas fa-database"></i> Veritabanı</h4>
                                <p style="color: #999; font-size: 12px; margin: 5px 0;">Firebase/Supabase</p>
                            </div>
                            <span class="module-status status-inactive" id="database-status">Pasif</span>
                        </div>
                    </div>
                    <div class="module-card" data-module="reports">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4><i class="fas fa-chart-bar"></i> Raporlar</h4>
                                <p style="color: #999; font-size: 12px; margin: 5px 0;">Gerçek analitik</p>
                            </div>
                            <span class="module-status status-inactive" id="reports-status">Pasif</span>
                        </div>
                    </div>
                    <div class="module-card" data-module="contracts">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4><i class="fas fa-file-contract"></i> Sözleşmeler</h4>
                                <p style="color: #999; font-size: 12px; margin: 5px 0;">Dijital imza sistemi</p>
                            </div>
                            <span class="module-status status-inactive" id="contracts-status">Pasif</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="admin-main">
                <!-- NEW: Quick toolbar for Live Stream orchestration -->
                <div class="quick-toolbar" id="liveQuickToolbar">
                    <span class="qt-label"><i class="fas fa-broadcast-tower"></i> Canlı Yayın Hızlı İşlemler:</span>
                    <button class="btn" onclick="scrollToLive(); document.getElementById('awsAccessKeyId')?.focus()"><i class="fas fa-link"></i> AWS'e Bağlan</button>
                    <button class="btn" onclick="scrollToLive(); document.getElementById('streamerEmail')?.focus()"><i class="fas fa-user-plus"></i> Dakika Ekle</button>
                    <button class="btn primary" onclick="scrollToLive(); document.getElementById('broadcastId')?.focus()"><i class="fas fa-plus"></i> Yayın Oluştur & Ata</button>
                    <button class="btn" onclick="listStreamers(); scrollToLive();"><i class="fas fa-users"></i> Yayıncıları Listele</button>
                    <button class="btn" onclick="listPayments(); scrollToLive();"><i class="fas fa-receipt"></i> Ödemeleri Göster</button>
                </div>

                <div id="moduleSettings">
                    <h2><i class="fas fa-cog"></i> Modül Ayarları</h2>
                    <p>Sol taraftan bir modül seçin</p>
                </div>

                <!-- Live Stream Settings -->
                <div class="settings-form" id="livestream-settings">
                    <h3><i class="fas fa-broadcast-tower"></i> Canlı Yayın Ayarları</h3>
                    <form id="livestreamConfigForm">
                        <div class="form-group">
                            <label>AWS IVS Region:</label>
                            <select id="awsRegion">
                                <option value="us-east-1">US East (N. Virginia)</option>
                                <option value="us-west-2">US West (Oregon)</option>
                                <option value="eu-west-1">Europe (Ireland)</option>
                                <option value="ap-southeast-1">Asia Pacific (Singapore)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Admin Token (x-admin-token):</label>
                            <input type="text" id="adminToken" placeholder="ADMIN_TOKEN">
                        </div>
                        <hr class="section-divider">
                        <div class="section-title"><i class="fas fa-screwdriver-wrench"></i> IVS Orchestrator</div>
                        <div class="form-grid">
                            <input type="text" id="awsAccessKeyId" placeholder="AWS Access Key ID">
                            <input type="password" id="awsSecretAccessKey" placeholder="AWS Secret Access Key">
                        </div>
                        <div class="btn-row">
                            <button type="button" class="btn" onclick="setAwsCreds()"><i class="fas fa-link"></i> AWS'e Bağlan</button>
                        </div>
                        <div class="section-title"><i class="fas fa-user-clock"></i> Yayıncı Dakika Yönetimi</div>
                        <div class="form-grid">
                            <input type="email" id="streamerEmail" placeholder="publisher@basvideo.com">
                            <input type="number" id="minutesToAdd" placeholder="Dakika (örn: 120)">
                        </div>
                        <div class="btn-row">
                            <button type="button" class="btn" onclick="addStreamerMinutes()"><i class="fas fa-plus"></i> Dakika Ekle</button>
                            <button type="button" class="btn" onclick="listStreamers()"><i class="fas fa-users"></i> Yayıncıları Listele</button>
                            <button type="button" class="btn" onclick="listPayments()"><i class="fas fa-receipt"></i> Ödemeleri Göster</button>
                        </div>
                        <div class="section-title"><i class="fas fa-bolt"></i> Yayın Oluştur ve Ata</div>
                        <div class="form-grid">
                            <input type="text" id="broadcastId" placeholder="yayin-001">
                            <input type="text" id="ivsName" placeholder="Kanal adı (opsiyonel)">
                        </div>
                        <div class="btn-row">
                            <button type="button" class="btn primary" onclick="createAndAssignBroadcast()"><i class="fas fa-plus"></i> Oluştur & Ata</button>
                            <button type="button" class="btn" onclick="oneClickPrepare()"><i class="fas fa-magic"></i> Tek Tıkla Yayın Hazırla</button>
                        </div>
                        <div class="section-title"><i class="fas fa-wrench"></i> IVS Yardımcıları</div>
                        <div class="form-grid">
                            <select id="ivsType">
                                <option value="BASIC">BASIC</option>
                                <option value="STANDARD">STANDARD</option>
                            </select>
                            <select id="ivsLatency">
                                <option value="LOW">LOW</option>
                                <option value="NORMAL">NORMAL</option>
                            </select>
                        </div>
                        <div class="btn-row">
                            <button type="button" class="btn" onclick="listIvsChannels()"><i class="fas fa-list"></i> Kanalları Listele</button>
                            <button type="button" class="btn" onclick="deleteIvsChannel()"><i class="fas fa-trash"></i> Kanalı Sil</button>
                        </div>
                        <div class="form-group" style="margin-top:10px;">
                            <label>Playback URL:</label>
                            <input type="text" id="playbackUrl" placeholder="https://...playback.live-video.net/...channel.XYZ.m3u8">
                            <div class="btn-row">
                                <button type="button" class="btn" onclick="parsePlaybackUrl()"><i class="fas fa-search"></i> Channel ID Çıkar</button>
                                <button type="button" class="btn" onclick="getChannelById()"><i class="fas fa-info-circle"></i> Channel ID ile Getir</button>
                                <button type="button" class="btn" onclick="listStreamKeys()"><i class="fas fa-key"></i> Anahtarları Listele</button>
                            </div>
                        </div>
                        <div class="result-box mono" id="ivsResult">Sonuçlar burada görünecek…</div>
                        <div class="form-actions" style="margin-top: 12px;">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Kaydet
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Email Service Settings -->
                <div class="settings-form" id="email-settings">
                    <h3><i class="fas fa-envelope"></i> E-posta Servisi Ayarları</h3>
                    <form id="emailConfigForm">
                        <div class="form-group">
                            <label>EmailJS Service ID:</label>
                            <input type="text" id="emailjsServiceId" placeholder="service_xxxxxxx">
                        </div>
                        <div class="form-group">
                            <label>EmailJS Template ID:</label>
                            <input type="text" id="emailjsTemplateId" placeholder="template_xxxxxxx">
                        </div>
                        <div class="form-group">
                            <label>EmailJS Public Key:</label>
                            <input type="text" id="emailjsPublicKey" placeholder="xxxxxxxxxxxxxxx">
                        </div>
                        <div class="form-group">
                            <label>Test E-posta:</label>
                            <input type="email" id="testEmail" placeholder="test@example.com">
                        </div>
                        <div class="form-actions">
                            <button type="button" onclick="testEmailService()" class="btn btn-secondary">
                                <i class="fas fa-paper-plane"></i> Test Gönder
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Kaydet
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Payment System Settings -->
                <div class="settings-form" id="payment-settings">
                    <h3><i class="fas fa-credit-card"></i> Ödeme Sistemi Ayarları</h3>
                    <form id="paymentConfigForm">
                        <div class="form-group">
                            <label>Stripe Public Key:</label>
                            <input type="text" id="stripePublicKey" placeholder="pk_test_xxxxxxx">
                        </div>
                        <div class="form-group">
                            <label>Stripe Secret Key:</label>
                            <input type="password" id="stripeSecretKey" placeholder="sk_test_xxxxxxx">
                        </div>
                        <div class="form-group">
                            <label>PayPal Client ID:</label>
                            <input type="text" id="paypalClientId" placeholder="xxxxxxxxxxxxxxx">
                        </div>
                        <div class="form-group">
                            <label>Test Modu:</label>
                            <input type="checkbox" id="testMode" checked>
                        </div>
                        <div class="form-actions">
                            <button type="button" onclick="testPaymentSystem()" class="btn btn-secondary">
                                <i class="fas fa-credit-card"></i> Test Ödeme
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Kaydet
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Cargo Tracking Settings -->
                <div class="settings-form" id="cargo-settings">
                    <h3><i class="fas fa-truck"></i> Kargo Takip Ayarları</h3>
                    <form id="cargoConfigForm">
                        <div class="form-group">
                            <label>Aras Kargo API Key:</label>
                            <input type="text" id="arasApiKey" placeholder="xxxxxxxxxxxxxxx">
                        </div>
                        <div class="form-group">
                            <label>Aras Kargo Secret:</label>
                            <input type="password" id="arasSecret" placeholder="xxxxxxxxxxxxxxx">
                        </div>
                        <div class="form-group">
                            <label>MNG Kargo API Key:</label>
                            <input type="text" id="mngApiKey" placeholder="xxxxxxxxxxxxxxx">
                        </div>
                        <div class="form-group">
                            <label>Yurtiçi Kargo API Key:</label>
                            <input type="text" id="yurticiApiKey" placeholder="xxxxxxxxxxxxxxx">
                        </div>
                        <div class="form-actions">
                            <button type="button" onclick="testCargoTracking()" class="btn btn-secondary">
                                <i class="fas fa-truck"></i> Test Takip
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Kaydet
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Notifications Settings -->
                <div class="settings-form" id="notifications-settings">
                    <h3><i class="fas fa-bell"></i> Bildirim Sistemi Ayarları</h3>
                    <form id="notificationsConfigForm">
                        <div class="form-group">
                            <label>Firebase Config:</label>
                            <textarea id="firebaseConfig" rows="10" placeholder='{
  "apiKey": "AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
  "authDomain": "your-project.firebaseapp.com",
  "projectId": "your-project-id",
  "storageBucket": "your-project.appspot.com",
  "messagingSenderId": "123456789012",
  "appId": "1:123456789012:web:abcdef1234567890"
}'></textarea>
                        </div>
                        <div class="form-group">
                            <label>VAPID Key:</label>
                            <input type="text" id="vapidKey" placeholder="BEl62iUYgUivxIkv69yViEuiBIa40HI...">
                        </div>
                        <div class="form-actions">
                            <button type="button" onclick="testNotifications()" class="btn btn-secondary">
                                <i class="fas fa-bell"></i> Test Bildirim
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Kaydet
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Database Settings -->
                <div class="settings-form" id="database-settings">
                    <h3><i class="fas fa-database"></i> Veritabanı Ayarları</h3>
                    <form id="databaseConfigForm">
                        <div class="form-group">
                            <label>Veritabanı Türü:</label>
                            <select id="databaseType">
                                <option value="firebase">Firebase Firestore</option>
                                <option value="supabase">Supabase PostgreSQL</option>
                                <option value="mongodb">MongoDB Atlas</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Connection String:</label>
                            <input type="text" id="databaseUrl" placeholder="mongodb+srv://user:pass@cluster.mongodb.net/db">
                        </div>
                        <div class="form-group">
                            <label>API Key:</label>
                            <input type="text" id="databaseApiKey" placeholder="xxxxxxxxxxxxxxx">
                        </div>
                        <div class="form-actions">
                            <button type="button" onclick="testDatabase()" class="btn btn-secondary">
                                <i class="fas fa-database"></i> Test Bağlantı
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Kaydet
                            </button>
                        </div>
                    </form>
                </div>

                <!-- User Permissions -->
                <div class="settings-form" id="permissions-settings">
                    <h3><i class="fas fa-users-cog"></i> Kullanıcı Yetkilendirme</h3>
                    <div class="permission-matrix">
                        <div class="permission-header">Modül</div>
                        <div class="permission-header">CEO</div>
                        <div class="permission-header">Admin</div>
                        <div class="permission-header">Moderatör</div>
                        <div class="permission-header">Satıcı</div>
                        <div class="permission-header">Müşteri</div>

                        <div class="permission-cell">E-posta Servisi</div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked disabled></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox"></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox"></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox"></div>

                        <div class="permission-cell">Ödeme Sistemi</div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked disabled></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox"></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>

                        <div class="permission-cell">Canlı Yayın</div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked disabled></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox"></div>

                        <div class="permission-cell">Kargo Takip</div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked disabled></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>

                        <div class="permission-cell">Stok Yönetimi</div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked disabled></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox"></div>

                        <div class="permission-cell">Bildirimler</div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked disabled></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                    </div>
                    <div class="form-actions" style="margin-top: 20px;">
                        <button type="button" onclick="savePermissions()" class="btn btn-primary">
                            <i class="fas fa-save"></i> Yetkileri Kaydet
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="../app.js"></script>
    <script src="panel-app.js"></script>
    <script src="../services/ceo-admin-service.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const moduleCards = document.querySelectorAll('.module-card');
            const settingsForms = document.querySelectorAll('.settings-form');
            moduleCards.forEach(card => {
                card.addEventListener('click', function() {
                    moduleCards.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    settingsForms.forEach(form => form.classList.remove('active'));
                    const moduleType = this.dataset.module;
                    const settingsForm = document.getElementById(moduleType + '-settings');
                    if (settingsForm) settingsForm.classList.add('active');
                });
            });
            // NEW: Auto-select Live Stream module by default
            const liveCard = document.querySelector('.module-card[data-module="livestream"]');
            const liveForm = document.getElementById('livestream-settings');
            if (liveCard && liveForm) {
                liveCard.classList.add('active');
                liveForm.classList.add('active');
                // ensure quick toolbar visible
                document.getElementById('liveQuickToolbar')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            // Prefill admin token from localStorage if present
            try {
                const t = localStorage.getItem('adminToken');
                if (t && document.getElementById('adminToken')) document.getElementById('adminToken').value = t;
            } catch(_) {}
            updateRealTimeStats();
            setInterval(updateRealTimeStats, 5000);
            loadModuleConfigurations();
        });
        function scrollToLive() {
            const el = document.getElementById('livestream-settings');
            if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        function updateRealTimeStats() {
            document.getElementById('activeUsers').textContent = Math.floor(Math.random() * 100) + 50;
            document.getElementById('liveStreams').textContent = Math.floor(Math.random() * 10) + 2;
            document.getElementById('totalOrders').textContent = Math.floor(Math.random() * 1000) + 500;
            document.getElementById('systemHealth').textContent = '98%';
        }
        function loadModuleConfigurations() {
            const configs = JSON.parse(localStorage.getItem('moduleConfigurations') || '{}');
            Object.keys(configs).forEach(module => {
                const config = configs[module];
                Object.keys(config).forEach(key => {
                    const input = document.getElementById(key);
                    if (input) input.value = config[key];
                });
            });
        }
        function saveModuleConfiguration(module) {
            const form = document.getElementById(module + 'ConfigForm');
            const formData = new FormData(form);
            const config = {};
            for (let [key, value] of formData.entries()) config[key] = value;
            const configs = JSON.parse(localStorage.getItem('moduleConfigurations') || '{}');
            configs[module] = config;
            localStorage.setItem('moduleConfigurations', JSON.stringify(configs));
            alert(`${module} modülü ayarları kaydedildi!`);
        }
        document.getElementById('livestreamConfigForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveModuleConfiguration('livestream');
        });
        document.getElementById('emailConfigForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveModuleConfiguration('email');
        });
        document.getElementById('paymentConfigForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveModuleConfiguration('payment');
        });
        document.getElementById('cargoConfigForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveModuleConfiguration('cargo');
        });
        document.getElementById('notificationsConfigForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveModuleConfiguration('notifications');
        });
        document.getElementById('databaseConfigForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveModuleConfiguration('database');
        });
        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = '../index.html';
        }
        function getAdminToken() {
            const val = (document.getElementById('adminToken')?.value || '').trim();
            if (val) { try { localStorage.setItem('adminToken', val); } catch(_) {} }
            if (val) return val;
            try { return (localStorage.getItem('adminToken') || '').trim(); } catch(_) { return ''; }
        }
        function apiHeaders() {
            const h = { 'Content-Type': 'application/json' };
            const t = getAdminToken();
            if (t) h['x-admin-token'] = t;
            return h;
        }
        function setResult(obj) {
            const el = document.getElementById('ivsResult');
            if (el) el.textContent = typeof obj === 'string' ? obj : JSON.stringify(obj, null, 2);
        }
        async function parseResponse(resp) {
            const ct = (resp.headers.get('content-type') || '').toLowerCase();
            if (ct.includes('application/json')) {
                return await resp.json();
            }
            const text = await resp.text();
            return { nonJson: true, status: resp.status, url: resp.url, bodyPreview: text.slice(0, 500) };
        }
        async function setAwsCreds() {
            try {
                const accessKeyId = document.getElementById('awsAccessKeyId').value.trim();
                const secretAccessKey = document.getElementById('awsSecretAccessKey').value.trim();
                const region = document.getElementById('awsRegion').value;
                if (!accessKeyId || !secretAccessKey) {
                    const v0 = await fetch('/api/admin/aws/verify', { headers: apiHeaders() });
                    const v0j = await parseResponse(v0);
                    if (v0.ok) { setResult({ message: 'Sunucu kimlik bilgileri ile doğrulandı', verify: v0j }); return; }
                }
                const resp = await fetch('/api/admin/aws/creds', {
                    method: 'POST', headers: apiHeaders(), body: JSON.stringify({ accessKeyId, secretAccessKey, region })
                });
                const credsRes = await parseResponse(resp);
                if (!resp.ok) { setResult(credsRes); return; }
                // immediately verify connectivity
                const v = await fetch('/api/admin/aws/verify', { headers: apiHeaders() });
                const vj = await parseResponse(v);
                if (v.ok) {
                    setResult({ message: 'AWS bağlantısı başarılı', verify: vj, creds: credsRes });
                } else {
                    setResult({ message: 'AWS bağlantısı doğrulanamadı', error: vj });
                }
            } catch (e) { setResult('Hata: ' + e.message); }
        }
        async function addStreamerMinutes() {
            try {
                const email = document.getElementById('streamerEmail').value.trim();
                const minutes = parseInt(document.getElementById('minutesToAdd').value || '0', 10);
                const resp = await fetch('/api/admin/streamers/add', {
                    method: 'POST', headers: apiHeaders(), body: JSON.stringify({ email, minutes })
                });
                setResult(await resp.json());
            } catch (e) { setResult('Hata: ' + e.message); }
        }
        async function listStreamers() {
            try {
                const resp = await fetch('/api/admin/streamers', { headers: apiHeaders() });
                setResult(await resp.json());
            } catch (e) { setResult('Hata: ' + e.message); }
        }
        async function listPayments() {
            try {
                const resp = await fetch('/api/admin/payments', { headers: apiHeaders() });
                setResult(await resp.json());
            } catch (e) { setResult('Hata: ' + e.message); }
        }
        async function createAndAssignBroadcast() {
            try {
                const streamerEmail = document.getElementById('streamerEmail').value.trim();
                const broadcastId = document.getElementById('broadcastId').value.trim();
                const name = document.getElementById('ivsName').value.trim() || undefined;
                const resp = await fetch('/api/admin/broadcasts/create', {
                    method: 'POST', headers: apiHeaders(), body: JSON.stringify({ streamerEmail, broadcastId, name })
                });
                const data = await resp.json();
                setResult(data);
            } catch (e) { setResult('Hata: ' + e.message); }
        }
        async function oneClickPrepare() {
            try {
                let email = document.getElementById('streamerEmail').value.trim();
                if (!email) email = prompt('Yayıncı e‑posta:');
                if (!email) return;
                document.getElementById('streamerEmail').value = email;

                // dakika ekle (120)
                await fetch('/api/admin/streamers/add', {
                    method: 'POST', headers: apiHeaders(), body: JSON.stringify({ email, minutes: 120 })
                });

                const bid = 'yayin-' + Math.random().toString(36).slice(2, 7);
                document.getElementById('broadcastId').value = bid;

                const resp = await fetch('/api/admin/broadcasts/create', {
                    method: 'POST', headers: apiHeaders(), body: JSON.stringify({ streamerEmail: email, broadcastId: bid })
                });
                const data = await parseResponse(resp);
                if (resp.ok) {
                    setResult({ message: 'Yayın hazır', next: { streamerLink: `/live-stream.html?broadcast=${bid}` }, details: data });
                } else {
                    setResult(data);
                }
            } catch (e) { setResult('Hata: ' + e.message); }
        }
        async function parsePlaybackUrl() {
            try {
                const playbackUrl = document.getElementById('playbackUrl').value.trim();
                const resp = await fetch('/api/admin/ivs/parse-playback', {
                    method: 'POST', headers: apiHeaders(), body: JSON.stringify({ playbackUrl })
                });
                setResult(await resp.json());
            } catch (e) { setResult('Hata: ' + e.message); }
        }
        async function listIvsChannels() {
            try {
                const resp = await fetch('/api/admin/ivs/channels', { headers: apiHeaders() });
                setResult(await resp.json());
            } catch (e) { setResult('Hata: ' + e.message); }
        }
        async function deleteIvsChannel() {
            try {
                const bid = document.getElementById('broadcastId').value.trim();
                const resp = await fetch('/api/admin/ivs/channel', {
                    method: 'DELETE', headers: apiHeaders(), body: JSON.stringify({ broadcastId: bid })
                });
                setResult(await resp.json());
            } catch (e) { setResult('Hata: ' + e.message); }
        }
        async function getChannelById() {
            try {
                const playbackUrl = document.getElementById('playbackUrl').value.trim();
                let channelId = playbackUrl.match(/\.channel\.([^.]+)\.m3u8$/)?.[1];
                if (!channelId) channelId = prompt('Channel ID girin:');
                if (!channelId) return;
                const resp = await fetch(`/api/admin/ivs/channel-by-id/${channelId}`, { headers: apiHeaders() });
                setResult(await resp.json());
            } catch (e) { setResult('Hata: ' + e.message); }
        }
        async function listStreamKeys() {
            try {
                const dataText = document.getElementById('ivsResult').textContent;
                const parsed = (() => { try { return JSON.parse(dataText); } catch(_) { return {}; }})();
                const channelArn = parsed?.channel?.arn || parsed?.channelArn || prompt('channelArn:');
                if (!channelArn) return setResult('channelArn gerekli');
                const resp = await fetch(`/api/admin/ivs/stream-keys?channelArn=${encodeURIComponent(channelArn)}`, { headers: apiHeaders() });
                setResult(await resp.json());
            } catch (e) { setResult('Hata: ' + e.message); }
        }
    </script>
</body>
</html>




