<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Müşteri Panel - VideoSat</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="panel-styles.css">
    <link rel="stylesheet" href="../modern-ui-enhancements.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="../text-readability-fix.css">
    <link rel="stylesheet" href="../color-contrast-fix.css"></head>
    <link rel="stylesheet" href="../red-white-black-theme.css"><body class="panel-body">
    <!-- Panel Navigation -->
    <nav class="panel-nav">
        <div class="panel-nav-container">
            <div class="panel-logo">
                <i class="fas fa-video"></i>
                <span>VideoSat</span>
                <span class="role-badge">Müşteri</span>
            </div>
            <div class="panel-nav-menu">
                <a href="#dashboard" class="nav-link active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    Dashboard
                </a>
                <a href="#products" class="nav-link" data-section="products">
                    <i class="fas fa-box-open"></i>
                    Ürünler
                </a>
                <a href="#sellers" class="nav-link" data-section="sellers">
                    <i class="fas fa-store"></i>
                    Satıcılar
                </a>
                <a href="#cart" class="nav-link" data-section="cart">
                    <i class="fas fa-shopping-cart"></i>
                    Sepet <span class="cart-badge" id="navCartBadge" style="display: none;">0</span>
                </a>
                <a href="#orders" class="nav-link" data-section="orders">
                    <i class="fas fa-file-invoice"></i>
                    Siparişlerim
                </a>
                <a href="#live-streams" class="nav-link" data-section="live-streams">
                    <i class="fas fa-broadcast-tower"></i>
                    Canlı Yayınlar
                </a>
                <a href="#following" class="nav-link" data-section="following">
                    <i class="fas fa-star"></i>
                    Takip Ettiğim Firmalar
                </a>
                <a href="#messages" class="nav-link" data-section="messages">
                    <i class="fas fa-envelope"></i>
                    Mesajlar
                </a>
                <a href="#reports" class="nav-link" data-section="reports">
                    <i class="fas fa-chart-line"></i>
                    Raporlar
                </a>
            </div>
            <div class="panel-user">
                <div class="user-welcome">
                    <i class="fas fa-hand-sparkles"></i>
                    <div class="welcome-text">
                        <span class="welcome-label">Hoşgeldiniz</span>
                        <span id="userCompanyName" class="welcome-name">Firma Adı</span>
                        <span id="userMemberNumber" class="welcome-member">Üye No: -</span>
                    </div>
                </div>
                <button class="btn btn-outline btn-small" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    Çıkış
                </button>
            </div>
        </div>
    </nav>

    <!-- Panel Content -->
    <main class="panel-main">
        <!-- Dashboard Section -->
        <section id="dashboard" class="panel-section active">
            <div class="section-header">
                <h1>Müşteri Dashboard</h1>
                <p>İşletmenizin genel durumunu takip edin</p>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-box"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalProducts">0</h3>
                        <p>Toplam Ürün</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalOrders">0</h3>
                        <p>Aktif Sipariş</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-industry"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalProducers">0</h3>
                        <p>Üretici Sayısı</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="liveStreamBalance">0</h3>
                        <p>Canlı Yayın Süresi (saat)</p>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <h2>Hızlı İşlemler</h2>
                <div class="actions-grid">
                    <button class="action-card" onclick="showSectionDirect('products')">
                        <i class="fas fa-box-open"></i>
                        <h3>Ürün Ara</h3>
                        <p>Satıcılardan ürün bulun</p>
                    </button>
                    <button class="action-card" onclick="showSectionDirect('sellers')">
                        <i class="fas fa-search"></i>
                        <h3>Satıcı Ara</h3>
                        <p>Yeni satıcılar bulun ve iletişime geçin</p>
                    </button>
                    <button class="action-card" onclick="showSectionDirect('orders')">
                        <i class="fas fa-shopping-cart"></i>
                        <h3>Siparişlerim</h3>
                        <p>Verdiğim siparişleri takip edin</p>
                    </button>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="recent-activity">
                <h2>Son Aktiviteler</h2>
                <div class="activity-list" id="recentActivityList">
                    <!-- Activity items will be populated by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Products Section -->
        <section id="products" class="panel-section">
            <div class="section-header">
                <h1>Ürünler</h1>
                <p>Satıcılardan ürün keşfedin ve sepete ekleyin</p>
            </div>

            <!-- Product Filters -->
            <div class="filters">
                <div class="filter-group">
                    <label>Kategori:</label>
                    <select id="productCategoryFilter">
                        <option value="">Tümü</option>
                        <option value="metal">Metal</option>
                        <option value="plastik">Plastik</option>
                        <option value="kimyasal">Kimyasal</option>
                        <option value="tekstil">Tekstil</option>
                        <option value="gida">Gıda</option>
                        <option value="diger">Diğer</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Birim:</label>
                    <select id="productUnitFilter">
                        <option value="">Tümü</option>
                        <option value="kg">Kilogram (kg)</option>
                        <option value="m2">Metrekare (m²)</option>
                        <option value="m3">Metreküp (m³)</option>
                        <option value="litre">Litre</option>
                        <option value="gram">Gram</option>
                        <option value="adet">Adet</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Arama:</label>
                    <input type="text" id="productSearch" placeholder="Ürün adı ara...">
                </div>
            </div>

            <!-- Products Table -->
            <div class="table-container">
                <table class="data-table" id="productsTable">
                    <thead>
                        <tr>
                            <th>Ürün Adı</th>
                            <th>Kategori</th>
                            <th>Birim</th>
                            <th>Stok</th>
                            <th>Birim Fiyat</th>
                            <th>Durum</th>
                            <th>İşlemler</th>
                            <th>Sepet</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <!-- Products will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Cart Section -->
        <section id="cart" class="panel-section">
            <div class="section-header">
                <h1><i class="fas fa-shopping-cart"></i> Sepetim</h1>
                <p>Sepetinizdeki ürünleri görüntüleyin ve sipariş verin</p>
            </div>

            <div id="cartContent">
                <!-- Cart items will be populated by JavaScript -->
            </div>
        </section>

        <!-- Sellers Section -->
        <section id="sellers" class="panel-section">
            <div class="section-header">
                <h1>Satıcılar</h1>
                <p>Sitedeki satıcıları bulun ve ürünlerini inceleyin</p>
            </div>

            <!-- Seller Filters -->
            <div class="filters">
                <div class="filter-group">
                    <label>Kategori:</label>
                    <select id="sellerCategoryFilter">
                        <option value="">Tümü</option>
                        <option value="elektronik">Elektronik</option>
                        <option value="giyim">Giyim</option>
                        <option value="ev">Ev Eşyası</option>
                        <option value="spor">Spor</option>
                        <option value="kitap">Kitap</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Fiyat Aralığı:</label>
                    <select id="sellerPriceFilter">
                        <option value="">Tümü</option>
                        <option value="0-1000">0 - 1.000 TL</option>
                        <option value="1000-5000">1.000 - 5.000 TL</option>
                        <option value="5000-10000">5.000 - 10.000 TL</option>
                        <option value="10000+">10.000+ TL</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Arama:</label>
                    <input type="text" id="sellerSearch" placeholder="Satıcı veya ürün ara...">
                </div>
            </div>

            <!-- Sellers Grid -->
            <div class="sellers-grid" id="sellersGrid">
                <!-- Sellers will be populated by JavaScript -->
            </div>
        </section>

        <!-- Orders Section -->
        <section id="orders" class="panel-section">
            <div class="section-header">
                <h1>Siparişlerim</h1>
                <p>Verdiğiniz siparişleri takip edin</p>
            </div>

            <!-- Order Tabs -->
            <div class="tabs">
                <button class="tab-btn active" data-tab="all">Tüm Siparişlerim</button>
                <button class="tab-btn" data-tab="pending">Bekleyen</button>
                <button class="tab-btn" data-tab="completed">Tamamlanan</button>
            </div>

            <!-- All Orders -->
            <div id="all" class="tab-content active">
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Sipariş No</th>
                                <th>Satıcı</th>
                                <th>Ürünler</th>
                                <th>Toplam Tutar</th>
                                <th>Tarih</th>
                                <th>Durum</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>
                        <tbody id="allOrdersBody">
                            <!-- Orders will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Pending Orders -->
            <div id="pending" class="tab-content">
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Sipariş No</th>
                                <th>Satıcı</th>
                                <th>Ürünler</th>
                                <th>Toplam Tutar</th>
                                <th>Tarih</th>
                                <th>Durum</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>
                        <tbody id="pendingOrdersBody">
                            <!-- Orders will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Completed Orders -->
            <div id="completed" class="tab-content">
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Sipariş No</th>
                                <th>Satıcı</th>
                                <th>Ürünler</th>
                                <th>Toplam Tutar</th>
                                <th>Tarih</th>
                                <th>Durum</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>
                        <tbody id="completedOrdersBody">
                            <!-- Orders will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Live Streams Section (Takip Edilen Firmaların Yayınları) -->
        <section id="live-streams" class="panel-section">
            <div class="section-header">
                <h1>Canlı Yayınlar</h1>
                <p>Takip ettiğiniz firmaların canlı yayınlarını izleyin</p>
            </div>

            <!-- Live Streams List -->
            <div class="live-streams-list" id="liveStreamsList">
                <!-- Will be populated by JavaScript -->
                <div style="text-align: center; padding: 40px; color: #999;">
                    <i class="fas fa-broadcast-tower" style="font-size: 64px; margin-bottom: 20px; opacity: 0.3;"></i>
                    <p>Henüz canlı yayın bulunmuyor</p>
                    <p style="font-size: 14px;">Firmalardan biri canlı yayın başlattığında burada görünecek</p>
                </div>
            </div>
        </section>

        <!-- Following Section -->
        <section id="following" class="panel-section">
            <div class="section-header">
                <h1>Takip Ettiğim Firmalar</h1>
                <p>Takip ettiğiniz firmaları yönetin ve onları canlı yayına davet edin</p>
            </div>

            <!-- Search -->
            <div style="margin-bottom: 20px;">
                <input type="text" id="followingSearch" placeholder="🔍 Firma ara..." style="width: 100%; padding: 12px; border: 1px solid #404040; border-radius: 8px; background: #1a1a1a; color: #ffffff;">
            </div>

            <!-- Following List -->
            <div class="following-list" id="followingList">
                <!-- Will be populated by JavaScript -->
            </div>
        </section>

        <!-- Messages Section -->
        <section id="messages" class="panel-section">
            <div class="section-header">
                <h1>Mesajlar</h1>
                <p>Üreticilerle iletişiminizi yönetin</p>
            </div>

            <div class="messages-container">
                <div class="messages-sidebar">
                    <div class="messages-search">
                        <input type="text" placeholder="Mesaj ara..." id="messageSearch">
                    </div>
                    <div class="messages-list" id="messagesList">
                        <!-- Messages will be populated by JavaScript -->
                    </div>
                </div>
                <div class="messages-content">
                    <div class="message-header">
                        <div class="message-contact-info">
                            <h3 id="selectedContactName">Bir konuşma seçin</h3>
                            <p id="selectedContactStatus">Durum</p>
                        </div>
                        <div class="message-actions">
                            <button class="btn btn-outline btn-small" onclick="showOfferForm()">
                                <i class="fas fa-file-contract"></i>
                                Teklif Gönder
                            </button>
                        </div>
                    </div>
                    <div class="message-messages" id="messageMessages">
                        <div class="no-message">
                            <i class="fas fa-comments"></i>
                            <p>Bir konuşma seçerek mesajlaşmaya başlayın</p>
                        </div>
                    </div>
                    <div class="message-input">
                        <input type="text" id="messageInput" placeholder="Mesaj yazın..." disabled>
                        <button onclick="sendMessage()" disabled>
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Reports Section -->
        <section id="reports" class="panel-section">
            <div class="section-header">
                <h1>Raporlar</h1>
                <p>İşletmenizin performansını analiz edin</p>
            </div>

            <div class="reports-grid">
                <div class="report-card">
                    <h3>Satış Raporu</h3>
                    <div class="report-chart" id="salesChart">
                        <!-- Chart will be populated by JavaScript -->
                    </div>
                </div>
                <div class="report-card">
                    <h3>Ürün Performansı</h3>
                    <div class="report-chart" id="productChart">
                        <!-- Chart will be populated by JavaScript -->
                    </div>
                </div>
                <div class="report-card">
                    <h3>Müşteri Analizi</h3>
                    <div class="report-chart" id="customerChart">
                        <!-- Chart will be populated by JavaScript -->
                    </div>
                </div>
                <div class="report-card">
                    <h3>Canlı Yayın İstatistikleri</h3>
                    <div class="report-chart" id="streamChart">
                        <!-- Chart will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Add Product Modal -->
    <div id="addProductModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Yeni Ürün Ekle</h2>
                <span class="close" onclick="closeModal('addProductModal')">&times;</span>
            </div>
            <form id="addProductForm" class="modal-form">
                <div class="form-group">
                    <label>Ürün Adı</label>
                    <input type="text" id="productName" required>
                </div>
                <div class="form-group">
                    <label>Kategori</label>
                    <select id="productCategory" required>
                        <option value="">Kategori seçin</option>
                        <option value="metal">Metal</option>
                        <option value="plastik">Plastik</option>
                        <option value="kimyasal">Kimyasal</option>
                        <option value="tekstil">Tekstil</option>
                        <option value="gida">Gıda</option>
                        <option value="diger">Diğer</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Birim</label>
                    <select id="productUnit" required>
                        <option value="">Birim seçin</option>
                        <option value="kg">Kilogram (kg)</option>
                        <option value="m2">Metrekare (m²)</option>
                        <option value="m3">Metreküp (m³)</option>
                        <option value="litre">Litre</option>
                        <option value="gram">Gram</option>
                        <option value="adet">Adet</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Stok Miktarı</label>
                    <input type="number" id="productStock" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Birim Fiyat (₺)</label>
                    <input type="number" id="productPrice" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Ürün Açıklaması</label>
                    <textarea id="productDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Ürün Resmi</label>
                    <input type="file" id="productImage" accept="image/*">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" onclick="closeModal('addProductModal')">
                        İptal
                    </button>
                    <button type="submit" class="btn btn-primary">
                        Ürün Ekle
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Buy Stream Time Modal -->
    <div id="buyStreamTimeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Canlı Yayın Süresi Satın Al</h2>
                <span class="close" onclick="closeModal('buyStreamTimeModal')">&times;</span>
            </div>
            <div class="stream-packages">
                <div class="package-card">
                    <h3>1 Saat</h3>
                    <div class="package-price">₺50</div>
                    <ul class="package-features">
                        <li>1 saat canlı yayın</li>
                        <li>Temel özellikler</li>
                    </ul>
                    <button class="btn btn-outline btn-block" onclick="buyStreamTime(1, 50)">Satın Al</button>
                </div>
                <div class="package-card featured">
                    <div class="package-badge">Popüler</div>
                    <h3>5 Saat</h3>
                    <div class="package-price">₺200</div>
                    <ul class="package-features">
                        <li>5 saat canlı yayın</li>
                        <li>Gelişmiş özellikler</li>
                        <li>%20 indirim</li>
                    </ul>
                    <button class="btn btn-primary btn-block" onclick="buyStreamTime(5, 200)">Satın Al</button>
                </div>
                <div class="package-card">
                    <h3>10 Saat</h3>
                    <div class="package-price">₺350</div>
                    <ul class="package-features">
                        <li>10 saat canlı yayın</li>
                        <li>Tüm özellikler</li>
                        <li>%30 indirim</li>
                    </ul>
                    <button class="btn btn-outline btn-block" onclick="buyStreamTime(10, 350)">Satın Al</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="skipPurchase()">
                    <i class="fas fa-forward"></i>
                    Bu Adımı Atla
                </button>
            </div>
        </div>
    </div>

    <!-- Alert Container -->
    <div id="alertContainer"></div>
    
    <!-- Scripts -->
    <!-- Module Loader -->
    <script src="../modules/module-loader.js"></script>
    
    <script src="../app.js"></script>
    <script src="../services/cart-service.js"></script>
    <script src="../services/stock-service.js"></script>
    <script src="../services/order-service.js"></script>
    <script src="../services/follow-service.js"></script>
    <script src="panel-app.js"></script>
    <script src="../services/payment-service.js"></script>
    
    <!-- FALLBACK FUNCTIONS - ALWAYS WORKS -->
    <script>
        function showSectionDirect(sectionId) {
            console.log('Switching to section:', sectionId);
            document.querySelectorAll('.panel-section').forEach(function(s) {
                s.classList.remove('active');
                s.style.display = 'none';
            });
            document.querySelectorAll('.nav-link').forEach(function(l) {
                l.classList.remove('active');
            });
            var target = document.getElementById(sectionId);
            if (target) {
                target.classList.add('active');
                target.style.display = 'block';
                console.log('✅ Section shown:', sectionId);
            }
        }
        window.showSection = showSectionDirect;
        
        function logoutDirect() {
            localStorage.removeItem('currentUser');
            localStorage.removeItem('liveStreamInvitations');
            window.location.href = '../index.html';
        }
        window.logout = logoutDirect;
        console.log('✅ Fallback functions loaded');
    </script>
</body>
</html>
